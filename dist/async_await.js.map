{"version":3,"sources":["../async_await.js"],"names":["fetch","require","getZhihuColumn","id","url","response","column","json","console","log","name","getZhihuColumn2","then","getZhihuColumn3","getZhihuColumn4","ApiClient","client","getZhihuColumn6","getZhihuColumn7","status","Error","showColumnInfo","err","sleep","timeout","Promise","setTimeout","resolve","getZhihuColumn8","showColumnInfo2","feweekly","toolingtips","showColumnInfo3","feweeklyPromise","toolingtipsPromise","showColumnInfo4","all"],"mappings":"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","file":"async_await.js","sourcesContent":["// 编写一个async/await函数\n\nconst fetch = require('node-fetch');\n\nasync function getZhihuColumn(id) {\n    const url = `https://zhuanlan.zhihu.com/api/columns/${id}`;\n    const response = await fetch(url);\n    const column = await response.json();\n    console.log(column.name + 1);\n}\n\ngetZhihuColumn('feweekly');\n\n// await必须和async搭配使用\n\n// 非async/await写法示例\n\nfunction getZhihuColumn2(id) {\n    const url = `https://zhuanlan.zhihu.com/api/columns/${id}`;\n    fetch(url)\n        .then(response => response.json())\n        .then(column => console.log(column.name + 2))\n}\n\ngetZhihuColumn2('feweekly');\n\n\n// 将async函数用在promisechain中\n// 所有的async函数都会返回一个Promise\n\nasync function getZhihuColumn3(id) {\n    const url = `https://zhuanlan.zhihu.com/api/columns/${id}`;\n    const response = await fetch(url);\n    return await response.json();\n}\n\ngetZhihuColumn3('feweekly')\n    .then(column => console.log(column.name + 3));\n\n\n// 将任意类型的函数转化成async风格\n\n// 函数表达式\n\nconst getZhihuColumn4 = async (id) => {\n    const url = `https://zhuanlan.zhihu.com/api/columns/${id}`;\n    const response = await fetch(url);\n    return await response.json();\n};\n\ngetZhihuColumn4('feweekly')\n    .then(column => console.log(column.name + 4));\n\n// 简化扁平结构\n(async () => {\n    const url = `https://zhuanlan.zhihu.com/api/columns/feweekly`;\n    const response = await fetch(url);\n    const column = await response.json();\n    console.log(column.name + 5);\n})();\n\n// 类方法\n\nclass ApiClient {\n    async getZhihuColumn6(id) {\n        const url = `https://zhuanlan.zhihu.com/api/columns/${id}`;\n        const response = await fetch(url);\n        return await response.json();\n    }\n}\n\nconst client = new ApiClient();\nclient.getZhihuColumn6('feweekly')\n    .then(column => console.log(column.name + 6));\n\n\n// 处理async中的错误\n\nasync function getZhihuColumn7(id) {\n    const url = `https://zhuanlan.zhihu.com/api/columns/${id}`;\n    const response = await fetch(url);\n    if (response.status !== 200) {\n        throw new Error('Error!');\n    }\n    return await response.json();\n}\n\n// 通过try-cache捕获异常\n\nconst showColumnInfo = async (id) => {\n    try {\n        const column = await getZhihuColumn7(id);\n        console.log(column.name + 7)\n    } catch (err) {\n        console.log('Error1!');\n    }\n};\n\nshowColumnInfo('1212');\n\n\n// async/await串行并行\n\n//串行\n\nconst sleep = (timeout = 2000) => new Promise(resolve => {\n    setTimeout(resolve, timeout);\n});\n\nasync function getZhihuColumn8(id) {\n    await sleep(2000);\n    const url = `https://zhuanlan.zhihu.com/api/columns/${id}`;\n    const response = await fetch(url);\n    return await response.json();\n}\n\nconst showColumnInfo2 = async () => {\n    const feweekly = await getZhihuColumn8('feweekly');\n    const toolingtips = await getZhihuColumn8('toolingtips');\n\n    console.log(feweekly.name + 'X');\n    console.log(toolingtips.name + 'X');\n};\n\nshowColumnInfo2();\n\n// 并行\n\nconst showColumnInfo3 = async () => {\n    const feweeklyPromise = getZhihuColumn8('feweekly');\n    const toolingtipsPromise = getZhihuColumn8('toolingtips');\n\n    const feweekly = await feweeklyPromise;\n    const toolingtips = await toolingtipsPromise;\n\n    console.log(feweekly.name + 'XX');\n    console.log(toolingtips.name + 'XX');\n};\n\n// Promise.all()并行\n\nconst showColumnInfo4 = async () => {\n    const [feweekly, toolingtips] = await Promise.all([\n        getZhihuColumn8('feweekly'),\n        getZhihuColumn8('toolingtips')\n    ]);\n\n    console.log(feweekly.name + 'XXX');\n    console.log(toolingtips.name + 'XXX');\n};\n\n"]}